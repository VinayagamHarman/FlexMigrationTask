/**
 * Generated by Apache Royale Compiler from org/apache/royale/textLayout/edit/mementos/DeleteTextMemento.as
 * org.apache.royale.textLayout.edit.mementos.DeleteTextMemento
 *
 * @fileoverview
 *
 * @suppress {missingRequire|checkTypes|accessControls}
 */

goog.provide('org.apache.royale.textLayout.edit.mementos.DeleteTextMemento');
/* Royale Dependency List: org.apache.royale.textLayout.edit.ElementMark,org.apache.royale.textLayout.elements.FlowElement,org.apache.royale.textLayout.elements.IFlowElement,org.apache.royale.textLayout.elements.IFlowGroupElement,org.apache.royale.textLayout.elements.IFlowLeafElement,org.apache.royale.textLayout.elements.ITextFlow,XML*/

goog.require('org.apache.royale.textLayout.edit.mementos.BaseMemento');
goog.require('org.apache.royale.textLayout.edit.IMemento');



/**
 * @constructor
 * @extends {org.apache.royale.textLayout.edit.mementos.BaseMemento}
 * @implements {org.apache.royale.textLayout.edit.IMemento}
 * @param {org.apache.royale.textLayout.elements.ITextFlow} textFlow
 * @param {number} absoluteStart
 * @param {number} absoluteEnd
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento = function(textFlow, absoluteStart, absoluteEnd) {
  org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.base(this, 'constructor', textFlow);
  var /** @type {org.apache.royale.textLayout.elements.IFlowLeafElement} */ startLeaf = textFlow.findLeaf(absoluteStart);
  var /** @type {org.apache.royale.textLayout.elements.IFlowGroupElement} */ cRoot = startLeaf.getParagraph().parent;
  while (cRoot && cRoot.parent && (cRoot.getAbsoluteStart() + cRoot.textLength < absoluteEnd || (cRoot.getAbsoluteStart() == absoluteStart && cRoot.getAbsoluteStart() + cRoot.textLength == absoluteEnd)))
    cRoot = cRoot.parent;
  if (cRoot) {
    var /** @type {number} */ rootStart = cRoot.getAbsoluteStart();
    this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex = cRoot.findChildIndexAtPosition((absoluteStart - rootStart) >> 0);
    this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__endChildIndex = cRoot.findChildIndexAtPosition((absoluteEnd - rootStart - 1) >> 0);
    if (this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__endChildIndex < 0)
      this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__endChildIndex = (cRoot.numChildren - 1) >> 0;
    var /** @type {org.apache.royale.textLayout.elements.IFlowElement} */ startChild = cRoot.getChildAt(this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex);
    var /** @type {number} */ absoluteStartAdjusted = startChild.getAbsoluteStart();
    var /** @type {org.apache.royale.textLayout.elements.IFlowElement} */ endChild = cRoot.getChildAt(this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__endChildIndex);
    var /** @type {number} */ absoluteEndAdjusted = (endChild.getAbsoluteStart() + endChild.textLength) >> 0;
    this.replaceCount = 0;
    if (this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex == this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__endChildIndex) {
      if (absoluteStartAdjusted < absoluteStart || absoluteEndAdjusted > absoluteEnd)
        this.replaceCount = 1;
    } else {
      if (absoluteStartAdjusted < absoluteStart)
        this.replaceCount++;
      if (absoluteEndAdjusted > absoluteEnd)
        this.replaceCount++;
    }
    var /** @type {org.apache.royale.textLayout.elements.IFlowGroupElement} */ scrapRoot = cRoot.deepCopy((absoluteStartAdjusted - rootStart) >> 0, (absoluteEndAdjusted - rootStart) >> 0);
    this.scrapChildren = scrapRoot.mxmlChildren;
  }
  this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__commonRootMark = new org.apache.royale.textLayout.edit.ElementMark(cRoot, 0);
  this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__absoluteStart = absoluteStart;
};
goog.inherits(org.apache.royale.textLayout.edit.mementos.DeleteTextMemento, org.apache.royale.textLayout.edit.mementos.BaseMemento);


/**
 * Prevent renaming of class. Needed for reflection.
 */
goog.exportSymbol('org.apache.royale.textLayout.edit.mementos.DeleteTextMemento', org.apache.royale.textLayout.edit.mementos.DeleteTextMemento);


/**
 * @private
 * @type {org.apache.royale.textLayout.edit.ElementMark}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__commonRootMark;


/**
 * @private
 * @type {number}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex = 0;


/**
 * @private
 * @type {number}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__endChildIndex = 0;


/**
 * @private
 * @type {Array}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__originalChildren;


/**
 * @private
 * @type {number}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__absoluteStart = 0;


/**
 * @protected
 * @type {Array}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.scrapChildren;


/**
 * @protected
 * @type {number}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.replaceCount = 0;


/**
 * @export
 * @return {*}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.undo = function() {
  var /** @type {org.apache.royale.textLayout.elements.IFlowGroupElement} */ root = this.commonRoot;
  this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__originalChildren = [];
  for (var /** @type {number} */ childIndex = this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex; childIndex < this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex + this.replaceCount; ++childIndex)
    this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__originalChildren.push(root.getChildAt(childIndex));
  var /** @type {Array} */ addToFlow = [];
  var foreachiter0_target = this.scrapChildren;
  for (var foreachiter0 in foreachiter0_target) 
  {
  var element = foreachiter0_target[foreachiter0];
  
    addToFlow.push(element.deepCopy());}
  
  root.replaceChildren(this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex, (this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex + this.replaceCount) >> 0, addToFlow);
};


/**
 * @export
 * @return {*}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.redo = function() {
  this.commonRoot.replaceChildren(this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex, (this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__startChildIndex + this.scrapChildren.length) >> 0, this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__originalChildren);
};


org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.get__commonRoot = function() {
  return this.org_apache_royale_textLayout_edit_mementos_DeleteTextMemento__commonRootMark.findElement(this._textFlow);
};


Object.defineProperties(org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype, /** @lends {org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype} */ {
/**
  * @export
  * @type {org.apache.royale.textLayout.elements.IFlowGroupElement} */
commonRoot: {
get: org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.get__commonRoot}}
);


/**
 * Metadata
 *
 * @type {Object.<string, Array.<Object>>}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.ROYALE_CLASS_INFO = { names: [{ name: 'DeleteTextMemento', qName: 'org.apache.royale.textLayout.edit.mementos.DeleteTextMemento', kind: 'class' }], interfaces: [org.apache.royale.textLayout.edit.IMemento] };



/**
 * Reflection
 *
 * @return {Object.<string, Function>}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.ROYALE_REFLECTION_INFO = function () {
  return {
    accessors: function () {
      return {
        'commonRoot': { type: 'org.apache.royale.textLayout.elements.IFlowGroupElement', access: 'readonly', declaredBy: 'org.apache.royale.textLayout.edit.mementos.DeleteTextMemento'}
      };
    },
    methods: function () {
      return {
        'DeleteTextMemento': { type: '', declaredBy: 'org.apache.royale.textLayout.edit.mementos.DeleteTextMemento', parameters: function () { return [ 'org.apache.royale.textLayout.elements.ITextFlow', false ,'int', false ,'int', false ]; }},
        'undo': { type: '*', declaredBy: 'org.apache.royale.textLayout.edit.mementos.DeleteTextMemento'},
        'redo': { type: '*', declaredBy: 'org.apache.royale.textLayout.edit.mementos.DeleteTextMemento'}
      };
    }
  };
};
/**
 * @const
 * @type {number}
 */
org.apache.royale.textLayout.edit.mementos.DeleteTextMemento.prototype.ROYALE_COMPILE_FLAGS = 10;
